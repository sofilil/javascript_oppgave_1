var Ge=Object.defineProperty,We=Object.defineProperties;var He=Object.getOwnPropertyDescriptors;var be=Object.getOwnPropertySymbols;var Ke=Object.prototype.hasOwnProperty,Ye=Object.prototype.propertyIsEnumerable;var ue=(e,t,n)=>t in e?Ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,D=(e,t)=>{for(var n in t||(t={}))Ke.call(t,n)&&ue(e,n,t[n]);if(be)for(var n of be(t))Ye.call(t,n)&&ue(e,n,t[n]);return e},U=(e,t)=>We(e,He(t));var Z=(e,t,n)=>(ue(e,typeof t!="symbol"?t+"":t,n),n);import{c as Xe,s as qe,p as Je,u as Qe,t as Ie,r as R,a as Te,b as h,w as Y,d as pe,e as T,f as s,o as u,g as _,h as a,n as S,i as x,j as I,F as N,k as j,l as te,m as G,q as Ze,C as et,v as tt,x as nt,y as Fe,z as M,A as H,B as X,D as st,E as ot,G as k,H as lt,I as it,J as at,K as rt,L as ct,M as ut,P as ye,N as q,O as L,Q as F,S as dt,R as ke,T as ze,U as pt,V as ft,W as Ne,X as Ve,Y as vt,Z as mt,_ as xe,$ as ht,a0 as _t,a1 as gt,a2 as bt,a3 as yt,a4 as kt,a5 as $e,a6 as we,a7 as ee,a8 as xt,a9 as $t,aa as wt,ab as Ct,ac as Mt,ad as Re}from"./vendor.b5210afe.js";const St=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};St();class It{constructor(){Z(this,"filesMap",new Map);Z(this,"idMap",new Map);Z(this,"taskFileMap",new WeakMap)}getFiles(t){return t?t.map(n=>this.filesMap.get(n)):Array.from(this.filesMap.values())}getFilepaths(){return Array.from(this.filesMap.keys())}getFailedFilepaths(){return this.getFiles().filter(t=>{var n;return((n=t.result)==null?void 0:n.state)==="fail"}).map(t=>t.filepath)}collectFiles(t=[]){t.forEach(n=>{this.filesMap.set(n.filepath,n),this.updateId(n)})}updateId(t){this.idMap.get(t.id)!==t&&(this.idMap.set(t.id,t),t.type==="suite"&&t.tasks.forEach(n=>{this.updateId(n)}))}updateTasks(t){for(const[n,l]of t)this.idMap.has(n)&&(this.idMap.get(n).result=l)}updateUserLog(t){const n=t.taskId&&this.idMap.get(t.taskId);n&&(n.logs||(n.logs=[]),n.logs.push(t))}}function Ee(e){return e==null&&(e=[]),Array.isArray(e)?e:[e]}function Le(e){return Ee(e).flatMap(t=>t.type==="test"?[t]:t.tasks.flatMap(n=>n.type==="test"?[n]:Le(n)))}function ve(e=[]){return Ee(e).flatMap(t=>t.type==="test"?[t]:[t,...ve(t.tasks)])}function re(e){return Le(e).some(t=>{var l,i;const n=(i=(l=t.result)==null?void 0:l.error)==null?void 0:i.message;return n==null?void 0:n.match(/Snapshot .* mismatched/)})}function Tt(e){const t=[e.name];let n=e;for(;(n==null?void 0:n.suite)||(n==null?void 0:n.file);)n=n.suite||n.file,(n==null?void 0:n.name)&&t.unshift(n.name);return t}function Ft(e,t={}){const{handlers:n={},autoReconnect:l=!0,reconnectInterval:i=2e3,reconnectTries:o=10,reactive:r=y=>y,WebSocketConstructor:d=globalThis.WebSocket}=t;let p=o;const c=r({ws:new d(e),state:new It,waitForConnection:w,reconnect:v});c.state.filesMap=r(c.state.filesMap),c.state.idMap=r(c.state.idMap);let b;c.rpc=Xe({onCollected(y){var g;c.state.collectFiles(y),(g=n.onCollected)==null||g.call(n,y)},onTaskUpdate(y){var g;c.state.updateTasks(y),(g=n.onTaskUpdate)==null||g.call(n,y)},onUserConsoleLog(y){c.state.updateUserLog(y)},onFinished(y){var g;(g=n.onFinished)==null||g.call(n,y)}},{post:y=>c.ws.send(y),on:y=>b=y,serialize:qe,deserialize:Je});let f;function v(y=!1){y&&(p=o),c.ws=new WebSocket(e),m()}function m(){f=new Promise(y=>{c.ws.addEventListener("open",()=>{p=o,y()})}),c.ws.addEventListener("message",y=>{b(y.data)}),c.ws.addEventListener("close",()=>{p-=1,l&&p>0&&setTimeout(v,i)})}m();function w(){return f}return c}const Be=Qe("hash-params",{initialValue:{file:"",view:null}}),A=Ie(Be,"file"),B=Ie(Be,"view"),zt=location.port,Nt=[location.hostname,zt].filter(Boolean).join(":"),Vt=`${location.protocol==="https:"?"wss:":"ws:"}//${Nt}/__vitest_api__`,ne=R("idle"),z=Ft(Vt,{reactive:pe,handlers:{onTaskUpdate(){ne.value="running"},onFinished(){ne.value="idle"}}}),fe=Te({}),P=R("CONNECTING"),E=h(()=>z.state.getFiles()),C=h(()=>E.value.find(e=>e.id===A.value)),se=h(()=>ve(C.value).map(e=>(e==null?void 0:e.logs)||[]).flat()||[]),oe=e=>E.value.find(t=>t.id===e),Rt=h(()=>P.value==="OPEN"),de=h(()=>P.value==="CONNECTING");h(()=>P.value==="CLOSED");function Ce(e=z.state.getFiles()){return je(e)}function je(e){return e.forEach(t=>{delete t.result,ve(t).forEach(n=>delete n.result)}),z.rpc.rerun(e.map(t=>t.filepath))}function Et(){if(C.value)return je([C.value])}Y(()=>z.ws,e=>{P.value="CONNECTING",e.addEventListener("open",()=>{P.value="OPEN",z.state.filesMap.clear(),z.rpc.getFiles().then(t=>z.state.collectFiles(t)),z.rpc.getConfig().then(t=>fe.value=t)}),e.addEventListener("close",()=>{setTimeout(()=>{P.value==="CONNECTING"&&(P.value="CLOSED")},1e3)})},{immediate:!0});const Lt={"text-2xl":""},Bt=a("div",{"text-lg":"",op50:""}," Check your terminal or start a new server with `vitest --ui` ",-1),jt=T({setup(e){return(t,n)=>s(Rt)?I("",!0):(u(),_("div",{key:0,fixed:"","inset-0":"",p2:"","z-10":"","select-none":"",text:"center sm",bg:"overlay","backdrop-blur-sm":"","backdrop-saturate-0":"",onClick:n[0]||(n[0]=(...l)=>s(z).reconnect&&s(z).reconnect(...l))},[a("div",{"h-full":"",flex:"~ col gap-2","items-center":"","justify-center":"",class:S(s(de)?"animate-pulse":"")},[a("div",{text:"5xl",class:S(s(de)?"i-carbon:renew animate-spin animate-reverse":"i-carbon-wifi-off")},null,2),a("div",Lt,x(s(de)?"Connecting...":"Disconnected"),1),Bt],2)]))}});var W=(e,t)=>{const n=e.__vccOpts||e;for(const[l,i]of t)n[l]=i;return n};const Ot={"h-full":"",class:"scrolls"},At={key:0,class:"scrolls scrolls-rounded task-error"},Dt={key:1,bg:"green-500/10",text:"green-500 sm",p:"x4 y2","m-2":"",rounded:""},Pt=T({props:{file:null},setup(e){const t=e;function n(o,r){var d;return((d=o.result)==null?void 0:d.state)!=="fail"?[]:o.type==="test"?[U(D({},o),{level:r})]:[U(D({},o),{level:r}),...o.tasks.flatMap(p=>n(p,r+1))]}const l=h(()=>{var o;return((o=t.file)==null?void 0:o.tasks.flatMap(r=>n(r,0)))||[]});function i(o){return o.startsWith(fe.value.root)?o.slice(fe.value.root.length):o}return(o,r)=>(u(),_("div",Ot,[s(l).length?(u(!0),_(N,{key:0},j(s(l),d=>{var p;return u(),_("div",{key:d.id},[a("div",{bg:"red-500/10",text:"red-500 sm",p:"x3 y2","m-2":"",rounded:"",style:G({"margin-left":`${2*d.level+.5}rem`})},[te(x(d.name)+" ",1),((p=d.result)==null?void 0:p.error)?(u(),_("div",At,[a("pre",null,[a("b",null,x(d.result.error.name||d.result.error.nameStr),1),te(": "+x(d.result.error.message),1)]),(u(!0),_(N,null,j(d.result.error.stacks||[],(c,b)=>(u(),_("pre",{key:b,op80:""}," - "+x(i(c.file))+":"+x(c.line)+":"+x(c.column),1))),128))])):I("",!0)],4)])}),128)):(u(),_("div",Dt," All tests passed in this file "))]))}});var Ut=W(Pt,[["__scopeId","data-v-3955269f"]]);const Gt={key:0,"h-full":"",class:"scrolls",flex:"","flex-col":""},Wt={border:"b base","p-4":""},Ht=["textContent"],Kt={key:1,p6:""},Yt=te(" Log something in your test and it would print here. (e.g. "),Xt=a("pre",{inline:""},"console.log(foo)",-1),qt=te(") "),Jt=[Yt,Xt,qt],Qt=T({setup(e){function t(i){return new Date(i).toLocaleTimeString()}function n(i){return i.trim()}function l(i){const o=i&&z.state.idMap.get(i);return o?Tt(o).slice(1).join(" > "):"-"}return(i,o)=>{var r;return((r=s(se))==null?void 0:r.length)?(u(),_("div",Gt,[(u(!0),_(N,null,j(s(se),d=>(u(),_("div",{key:d.taskId,"font-mono":""},[a("div",Wt,[a("div",{"text-xs":"","mb-1":"",class:S(d.type==="stderr"?"text-red-600 dark:text-red-300":"op30")},x(t(d.time))+" | "+x(l(d.taskId))+" | "+x(d.type),3),a("pre",{textContent:x(n(d.content))},null,8,Ht)])]))),128))])):(u(),_("p",Kt,Jt))}}});function Zt(e,t,n={}){const l=et.fromTextArea(e.value,D({theme:"vars"},n));let i=!1;return l.on("change",()=>{if(i){i=!1;return}t.value=l.getValue()}),Y(t,o=>{if(o!==l.getValue()){i=!0;const r=l.listSelections();l.replaceRange(o,l.posFromIndex(0),l.posFromIndex(1/0)),l.setSelections(r)}},{immediate:!0}),Ze(l)}const en={relative:"","font-mono":"","text-sm":"",class:"scrolls"},Oe=T({props:{modelValue:null,mode:null,readOnly:{type:Boolean}},emits:["update:modelValue","save"],setup(e,{expose:t,emit:n}){const l=e,i=tt(),o={js:"javascript",mjs:"javascript",cjs:"javascript",ts:{name:"javascript",typescript:!0},mts:{name:"javascript",typescript:!0},cts:{name:"javascript",typescript:!0},jsx:{name:"javascript",jsx:!0},tsx:{name:"javascript",typescript:!0,jsx:!0}},r=R(),d=nt(l,"modelValue",n,{passive:!0}),p=Te();return t({cm:p}),Fe(async()=>{p.value=Zt(r,d,U(D(D({},l),i),{mode:o[l.mode||""]||l.mode,readOnly:l.readOnly?"nocursor":void 0,extraKeys:{"Cmd-S":function(c){n("save",c.getValue())},"Ctrl-S":function(c){n("save",c.getValue())}}})),p.value.setSize("100%","100%"),p.value.clearHistory(),setTimeout(()=>p.value.refresh(),100)}),(c,b)=>(u(),_("div",en,[a("textarea",{ref_key:"el",ref:r},null,512)]))}}),tn=T({props:{file:null},setup(e){const t=e,n=R("");Y(()=>t.file,async()=>{var f;if(!t.file||!((f=t.file)==null?void 0:f.filepath)){n.value="";return}n.value=await z.rpc.readFile(t.file.filepath)},{immediate:!0});const l=h(()=>{var f,v;return((v=(f=t.file)==null?void 0:f.filepath)==null?void 0:v.split(/\./g).pop())||"js"}),i=R(),o=h(()=>{var f;return(f=i.value)==null?void 0:f.cm}),r=h(()=>{var f;return((f=t.file)==null?void 0:f.tasks.filter(v=>{var m;return((m=v.result)==null?void 0:m.state)==="fail"}))||[]}),d=R(!1),p=[],c=[];async function b(f){d.value=!0,await z.rpc.writeFile(t.file.filepath,f)}return Y([o,r],()=>{!o.value||setTimeout(()=>{var f;p.forEach(v=>v.clear()),c.forEach(v=>{var m;return(m=o.value)==null?void 0:m.removeLineClass(v,"wrap")}),p.length=0,c.length=0,r.value.forEach(v=>{var y;const m=(y=v.result)==null?void 0:y.error,w=((m==null?void 0:m.stacks)||[]).filter(g=>{var $;return g.file&&g.file===(($=t.file)==null?void 0:$.filepath)});if(w.length){const g=w[0].sourcePos||w[0],$=document.createElement("pre");$.className="c-red-600 dark:c-red-400",$.textContent=`${" ".repeat(g.column)}^ ${m==null?void 0:m.nameStr}: ${m==null?void 0:m.message}`,c.push(o.value.addLineClass(g.line-1,"wrap","bg-red-500/10")),p.push(o.value.addLineWidget(g.line-1,$))}}),d.value||(f=o.value)==null||f.clearHistory()},100)},{flush:"post"}),(f,v)=>{const m=Oe;return u(),M(m,H({ref_key:"editor",ref:i,modelValue:n.value,"onUpdate:modelValue":v[0]||(v[0]=w=>n.value=w),"h-full":""},{lineNumbers:!0},{mode:s(l),onSave:b}),null,16,["modelValue","mode"])}}}),nn=T({props:{modelValue:{type:Boolean,default:!1},direction:{default:"bottom"}},emits:["update:modelValue"],setup(e){const t=e,n=h(()=>{switch(t.direction){case"bottom":return"bottom-0 left-0 right-0 border-t";case"top":return"top-0 left-0 right-0 border-b";case"left":return"bottom-0 left-0 top-0 border-r";case"right":return"bottom-0 top-0 right-0 border-l";default:return""}}),l=h(()=>{switch(t.direction){case"bottom":return"translateY(100%)";case"top":return"translateY(-100%)";case"left":return"translateX(-100%)";case"right":return"translateX(100%)";default:return""}});return(i,o)=>(u(),_("div",{class:S(["fixed inset-0 z-40",e.modelValue?"":"pointer-events-none"])},[a("div",{class:S(["bg-base inset-0 absolute transition-opacity duration-500 ease-out",e.modelValue?"opacity-50":"opacity-0"]),onClick:o[0]||(o[0]=r=>i.$emit("update:modelValue",!1))},null,2),a("div",{class:S(["bg-base border-base absolute transition-all duration-200 ease-out",[s(n),"scrolls"]]),style:G(e.modelValue?{}:{transform:s(l)})},[X(i.$slots,"default")],6)],2))}}),sn=["aria-label","opacity","hover"],J=T({props:{icon:null,title:null,disabled:{type:Boolean}},setup(e){return(t,n)=>(u(),_("button",{"aria-label":e.title,role:"button",opacity:e.disabled?10:70,rounded:"",hover:e.disabled?"":"bg-active op100",class:"w-1.4em h-1.4em flex"},[X(t.$slots,"default",{},()=>[a("div",{class:S(e.icon),ma:""},null,2)])],8,sn))}}),on={"w-350":"","max-w-screen":"","h-full":"",flex:"","flex-col":""},ln={"p-4":"",relative:""},an=a("p",null,"Module Info",-1),rn={op50:"","font-mono":"","text-sm":""},cn={key:0,"p-5":""},un={grid:"~ cols-2 rows-[min-content_auto]","overflow-hidden":"","flex-auto":""},dn=a("div",{p:"x3 y-1","bg-overlay":"",border:"base b t r"}," Source ",-1),pn=a("div",{p:"x3 y-1","bg-overlay":"",border:"base b t"}," Transformed ",-1),fn={key:0},vn={p:"x3 y-1","bg-overlay":"",border:"base b t"},mn=T({props:{id:null},emits:["close"],setup(e,{emit:t}){const n=e,l=st(()=>z.rpc.getTransformResult(n.id)),i=h(()=>{var p;return((p=n.id)==null?void 0:p.split(/\./g).pop())||"js"}),o=h(()=>{var p,c;return((c=(p=l.value)==null?void 0:p.source)==null?void 0:c.trim())||""}),r=h(()=>{var p,c;return((c=(p=l.value)==null?void 0:p.code)==null?void 0:c.replace(/\/\/# sourceMappingURL=.*\n/,"").trim())||""}),d=h(()=>{var p,c,b,f,v;return{mappings:(b=(c=(p=l.value)==null?void 0:p.map)==null?void 0:c.mappings)!=null?b:"",version:(v=(f=l.value)==null?void 0:f.map)==null?void 0:v.version}});return ot("Escape",()=>{t("close")}),(p,c)=>{const b=J,f=Oe;return u(),_("div",on,[a("div",ln,[an,a("p",rn,x(e.id),1),k(b,{icon:"i-carbon-close",absolute:"","top-5px":"","right-5px":"","text-2xl":"",onClick:c[0]||(c[0]=v=>t("close"))})]),s(l)?(u(),_(N,{key:1},[a("div",un,[dn,pn,k(f,H({"h-full":"","model-value":s(o),"read-only":""},{lineNumbers:!0},{mode:s(i)}),null,16,["model-value","mode"]),k(f,H({"h-full":"","model-value":s(r),"read-only":""},{lineNumbers:!0},{mode:s(i)}),null,16,["model-value","mode"])]),s(d).mappings!==""?(u(),_("div",fn,[a("div",vn," Source map (v"+x(s(d).version)+") ",1),k(f,H({"model-value":s(d).mappings,"read-only":""},{lineNumbers:!0},{mode:s(i)}),null,16,["model-value","mode"])])):I("",!0)],64)):(u(),_("div",cn," No transform result found for this module. "))])}}});const hn={"h-full":"","min-h-75":"","flex-1":"",overflow:"hidden"},_n={flex:"","items-center":"","gap-4":"","px-3":"","py-2":""},gn=["id","checked","onChange"],bn=["for"],yn=a("div",{"flex-auto":""},null,-1),kn=T({props:{graph:null},setup(e){const t=e,{graph:n}=lt(t),l=R(),i=R(!1),o=R(),r=R();it(()=>{i.value===!1&&setTimeout(()=>o.value=void 0,300)},{flush:"post"}),Fe(()=>{c()}),at(()=>{var f;(f=r.value)==null||f.shutdown()}),Y(n,c);function d(f,v){var m;(m=r.value)==null||m.filterNodesByType(v,f)}function p(f){o.value=f,i.value=!0}function c(){var f;(f=r.value)==null||f.shutdown(),!(!n.value||!l.value)&&(r.value=new rt(l.value,n.value,ct({nodeRadius:10,autoResize:!0,simulation:{alphas:{initialize:1,resize:({newHeight:v,newWidth:m})=>v===0&&m===0?0:.25},forces:{collision:{radiusMultiplier:10},link:{length:240}}},marker:ut.Arrow(2),modifiers:{node:b},positionInitializer:n.value.nodes.length>1?ye.Randomized:ye.Centered,zoom:{min:.5,max:2}})))}function b(f){const v=g=>g.button===0;let m=0,w=0,y=0;f.on("pointerdown",(g,$)=>{$.type!=="external"&&(!$.x||!$.y||!v(g)||(m=$.x,w=$.y,y=Date.now()))}).on("pointerup",(g,$)=>{if($.type==="external"||!$.x||!$.y||!v(g)||Date.now()-y>500)return;const V=$.x-m,Q=$.y-w;V**2+Q**2<100&&p($.id)})}return(f,v)=>{var $;const m=J,w=mn,y=nn,g=q("tooltip");return u(),_("div",hn,[a("div",null,[a("div",_n,[(u(!0),_(N,null,j(($=r.value)==null?void 0:$.nodeTypes.sort(),V=>{var Q;return u(),_("div",{key:V,flex:"~ gap-1","items-center":"","select-none":""},[a("input",{id:`type-${V}`,type:"checkbox",checked:(Q=r.value)==null?void 0:Q.nodeTypeFilter.includes(V),onChange:Ue=>d(V,Ue.target.checked)},null,40,gn),a("label",{"font-light":"","text-sm":"","ws-nowrap":"","overflow-hidden":"",capitalize:"",truncate:"",for:`type-${V}`,"border-b-2":"",style:G({"border-color":`var(--color-node-${V})`})},x(V)+" Modules",13,bn)])}),128)),yn,a("div",null,[L(k(m,{icon:"i-carbon-reset",onClick:c},null,512),[[g,"Reset",void 0,{bottom:!0}]])])])]),a("div",{ref_key:"el",ref:l},null,512),k(y,{modelValue:i.value,"onUpdate:modelValue":v[1]||(v[1]=V=>i.value=V),direction:"right"},{default:F(()=>[o.value?(u(),M(dt,{key:0},{default:F(()=>[k(w,{id:o.value,onClose:v[0]||(v[0]=V=>i.value=!1)},null,8,["id"])]),_:1})):I("",!0)]),_:1},8,["modelValue"])])}}}),xn={key:0,"text-green-500":"","flex-shrink-0":"","i-carbon:checkmark":""},$n={key:1,"text-red-500":"","flex-shrink-0":"","i-carbon:compare":""},wn={key:2,"text-red-500":"","flex-shrink-0":"","i-carbon:close":""},Cn={key:3,"text-gray-500":"","flex-shrink-0":"","i-carbon:document-blank":""},Mn={key:4,"text-gray-500":"","flex-shrink-0":"","i-carbon:redo":"","rotate-90":""},Sn={key:5,"text-yellow-500":"","flex-shrink-0":"","i-carbon:circle-dash":"","animate-spin":""},me=T({props:{task:null},setup(e){return(t,n)=>{var i,o,r;const l=q("tooltip");return((i=e.task.result)==null?void 0:i.state)==="pass"?(u(),_("div",xn)):s(re)(e.task)?L((u(),_("div",$n,null,512)),[[l,"Contains failed snapshot",void 0,{right:!0}]]):((o=e.task.result)==null?void 0:o.state)==="fail"?(u(),_("div",wn)):e.task.mode==="todo"?L((u(),_("div",Cn,null,512)),[[l,"Todo",void 0,{right:!0}]]):e.task.mode==="skip"||((r=e.task.result)==null?void 0:r.state)==="skip"?L((u(),_("div",Mn,null,512)),[[l,"Skipped",void 0,{right:!0}]]):(u(),_("div",Sn))}}});function In(e){let t=e;return t.includes("/node_modules/")?t=t.split(/\/node_modules\//g).pop().split(/\//g).shift():t=t.split(/\//g).pop(),ze({color:"var(--color-node-external)",label:{color:"var(--color-node-external)",fontSize:"0.875rem",text:t},isFocused:!1,id:e,type:"external"})}function Tn(e,t){return ze({color:t?"var(--color-node-root)":"var(--color-node-inline)",label:{color:t?"var(--color-node-root)":"var(--color-node-inline)",fontSize:"0.875rem",text:e.split(/\//g).pop()},isFocused:!1,id:e,type:"inline"})}function Fn(e,t){var d,p;if(!e)return ke({});const n=(d=e.externalized.map(c=>In(c)))!=null?d:[],l=(p=e.inlined.map(c=>Tn(c,c===t)))!=null?p:[],i=[...n,...l],o=Object.fromEntries(i.map(c=>[c.id,c])),r=Object.entries(e.graph).flatMap(([c,b])=>b.map(f=>{const v=o[c],m=o[f];if(!(v===void 0||m===void 0))return pt({source:v,target:m,color:"var(--color-link)",label:!1})}).filter(f=>f!==void 0));return ke({nodes:i,links:r})}const zn={key:0,flex:"","flex-col":"","h-full":"","max-h-full":"","overflow-hidden":""},Nn={p:"2","h-10":"",flex:"~ gap-2","items-center":"","bg-header":"",border:"b base"},Vn={"flex-1":"","font-light":"","op-50":"","ws-nowrap":"",truncate:"","text-sm":""},Rn={class:"flex text-lg"},En={flex:"~","items-center":"","bg-header":"",border:"b-2 base","text-sm":"","h-38px":""},Ln={flex:"","flex-col":"","flex-1":"",overflow:"hidden"},Bn=T({setup(e){const t=R({externalized:[],graph:{},inlined:[]}),n=R({nodes:[],links:[]});ft(C,async(o,r)=>{o&&o.filepath!==(r==null?void 0:r.filepath)&&(t.value=await z.rpc.getModuleGraph(o.filepath),n.value=Fn(t.value,o.filepath))},{debounce:100,immediate:!0});const l=()=>{var r;const o=(r=C.value)==null?void 0:r.filepath;o&&fetch(`/__open-in-editor?file=${encodeURIComponent(o)}`)},i=o=>{B.value=o};return(o,r)=>{var w,y,g,$;const d=me,p=J,c=kn,b=tn,f=Qt,v=Ut,m=q("tooltip");return s(C)?(u(),_("div",zn,[a("div",null,[a("div",Nn,[k(d,{task:s(C)},null,8,["task"]),a("div",Vn,x((w=s(C))==null?void 0:w.filepath),1),a("div",Rn,[L(k(p,{icon:"i-carbon-launch",disabled:!((y=s(C))==null?void 0:y.filepath),onClick:l},null,8,["disabled"]),[[m,"Open in editor",void 0,{bottom:!0}]])])]),a("div",En,[a("button",{"tab-button":"",class:S({"tab-button-active":s(B)==null}),onClick:r[0]||(r[0]=V=>i(null))}," Report ",2),a("button",{"tab-button":"",class:S({"tab-button-active":s(B)==="graph"}),onClick:r[1]||(r[1]=V=>i("graph"))}," Module Graph ",2),a("button",{"tab-button":"",class:S({"tab-button-active":s(B)==="editor"}),onClick:r[2]||(r[2]=V=>i("editor"))}," Code ",2),a("button",{"tab-button":"",class:S({"tab-button-active":s(B)==="console",op20:s(B)!=="console"&&((g=s(se))==null?void 0:g.length)===0}),onClick:r[3]||(r[3]=V=>i("console"))}," Console ("+x((($=s(se))==null?void 0:$.length)||0)+") ",3)])]),a("div",Ln,[L(k(c,{graph:n.value},null,8,["graph"]),[[Ne,s(B)==="graph"]]),s(B)==="editor"?(u(),M(b,{key:s(C).filepath,file:s(C)},null,8,["file"])):s(B)==="console"?(u(),M(f,{key:1,file:s(C)},null,8,["file"])):s(B)?I("",!0):(u(),M(v,{key:2,file:s(C)},null,8,["file"]))])])):I("",!0)}}});const jn=["open"],On=a("div",{"flex-1":"","h-1px":"",border:"base b",op80:""},null,-1),An=a("div",{"flex-1":"","h-1px":"",border:"base b",op80:""},null,-1),Dn=T({props:{color:null},setup(e){const t=R(!0);return(n,l)=>(u(),_("div",{open:t.value,class:"details-panel",onToggle:l[0]||(l[0]=i=>t.value=i.target.open)},[a("div",{p:"y1","text-sm":"","bg-base":"","items-center":"","z-5":"","gap-2":"",class:S(e.color),"w-full":"",flex:"","select-none":"",sticky:"",top:"-1"},[On,X(n.$slots,"summary",{open:t.value}),An],2),X(n.$slots,"default")],40,jn))}}),Pn={key:0,flex:"~ row","items-center":"",p:"x-2 y-1","border-rounded":"","cursor-pointer":"",hover:"bg-active"},Un=["text"],Gn={"text-sm":"",truncate:"","font-light":""},Wn={key:0,text:"xs",op20:"",style:{"white-space":"nowrap"}},Hn=T({props:{task:null},setup(e){const t=e,n=h(()=>{const{result:l}=t.task;return l&&Math.round(l.duration||0)});return(l,i)=>{var r,d;const o=me;return e.task?(u(),_("div",Pn,[k(o,{task:e.task,"mr-2":""},null,8,["task"]),a("div",{flex:"","items-end":"","gap-2":"",text:((d=(r=e.task)==null?void 0:r.result)==null?void 0:d.state)==="fail"?"red-500":""},[a("span",Gn,x(e.task.name),1),typeof s(n)=="number"?(u(),_("span",Wn,x(s(n)>0?s(n):"< 1")+"ms ",1)):I("",!0)],8,Un)])):I("",!0)}}}),Kn={key:1},Yn={inheritAttrs:!1},Xn=T(U(D({},Yn),{props:{task:null,indent:{default:0},nested:{type:Boolean,default:!1},search:null,onItemClick:null},setup(e){return(t,n)=>{const l=Hn,i=Ve("TaskTree",!0);return u(),_(N,null,[!e.search||e.task.name.includes(e.search)?(u(),M(l,H({key:0},t.$attrs,{task:e.task,style:{paddingLeft:`${e.indent*.75+1}rem`},onClick:n[0]||(n[0]=o=>e.onItemClick&&e.onItemClick(e.task))}),null,16,["task","style"])):I("",!0),e.nested&&e.task.type==="suite"&&e.task.tasks.length?(u(),_("div",Kn,[(u(!0),_(N,null,j(e.task.tasks,o=>(u(),M(i,{key:o.id,task:o,nested:e.nested,indent:e.indent+1,search:e.search,"on-item-click":e.onItemClick},null,8,["task","nested","indent","search","on-item-click"]))),128))])):I("",!0)],64)}}})),qn={h:"full",flex:"~ col"},Jn={p:"2","h-10":"",flex:"~ gap-2","items-center":"","bg-header":"",border:"b base"},Qn={p:"x3 y2",flex:"~ gap-2","items-center":"","bg-header":"",border:"b-2 base"},Zn=a("div",{"i-carbon:search":"","flex-shrink-0":""},null,-1),es=["op"],ts={class:"scrolls","flex-auto":"","py-1":""},ns={"text-red5":""},ss={"text-yellow5":""},os={"text-green5":""},ls={"text-purple5:50":""},is={key:2,flex:"~ col","items-center":"",p:"x4 y4","font-light":""},as=a("div",{op30:""}," No matched test ",-1),rs={inheritAttrs:!1},Ae=T(U(D({},rs),{props:{tasks:null,indent:{default:0},nested:{type:Boolean,default:!1},groupByType:{type:Boolean,default:!1},onItemClick:null},emits:["run"],setup(e,{emit:t}){const n=e,l=R(""),i=h(()=>l.value.trim()!==""),o=h(()=>l.value.trim()?n.tasks.filter(v=>v.name.includes(l.value)):n.tasks),r=h(()=>i.value?o.value.map(v=>oe(v.id)).filter(Boolean):[]),d=h(()=>o.value.filter(v=>{var m;return((m=v.result)==null?void 0:m.state)==="fail"})),p=h(()=>o.value.filter(v=>{var m;return((m=v.result)==null?void 0:m.state)==="pass"})),c=h(()=>o.value.filter(v=>v.mode==="skip"||v.mode==="todo")),b=h(()=>o.value.filter(v=>!d.value.includes(v)&&!p.value.includes(v)&&!c.value.includes(v))),f=vt(b,250);return(v,m)=>{const w=Xn,y=Dn;return u(),_("div",qn,[a("div",null,[a("div",Jn,[X(v.$slots,"header",{filteredTests:s(i)?s(r):void 0})]),a("div",Qn,[Zn,L(a("input",{"onUpdate:modelValue":m[0]||(m[0]=g=>l.value=g),placeholder:"Search...",outline:"none",bg:"transparent",font:"light",text:"sm","flex-1":"","pl-1":"",op:l.value.length?"100":"50",onKeydown:[m[1]||(m[1]=xe(g=>l.value="",["esc"])),m[2]||(m[2]=xe(g=>t("run",s(i)?s(r):void 0),["enter"]))]},null,40,es),[[mt,l.value]])])]),a("div",ts,[e.groupByType?(u(),_(N,{key:0},[s(d).length?(u(),M(y,{key:0},{summary:F(()=>[a("div",ns," FAIL ("+x(s(d).length)+") ",1)]),default:F(()=>[(u(!0),_(N,null,j(s(d),g=>(u(),M(w,{key:g.id,task:g,nested:e.nested,search:l.value,class:S(s(A)===g.id?"bg-active":""),"on-item-click":e.onItemClick},null,8,["task","nested","search","class","on-item-click"]))),128))]),_:1})):I("",!0),s(b).length||s(ne)==="running"?(u(),M(y,{key:1},{summary:F(()=>[a("div",ss," RUNNING ("+x(s(f).length)+") ",1)]),default:F(()=>[(u(!0),_(N,null,j(s(f),g=>(u(),M(w,{key:g.id,task:g,nested:e.nested,search:l.value,class:S(s(A)===g.id?"bg-active":""),"on-item-click":e.onItemClick},null,8,["task","nested","search","class","on-item-click"]))),128))]),_:1})):I("",!0),s(p).length?(u(),M(y,{key:2},{summary:F(()=>[a("div",os," PASS ("+x(s(p).length)+") ",1)]),default:F(()=>[(u(!0),_(N,null,j(s(p),g=>(u(),M(w,{key:g.id,task:g,nested:e.nested,search:l.value,class:S(s(A)===g.id?"bg-active":""),"on-item-click":e.onItemClick},null,8,["task","nested","search","class","on-item-click"]))),128))]),_:1})):I("",!0),s(c).length?(u(),M(y,{key:3},{summary:F(()=>[a("div",ls," SKIP ("+x(s(c).length)+") ",1)]),default:F(()=>[(u(!0),_(N,null,j(s(c),g=>(u(),M(w,{key:g.id,task:g,nested:e.nested,search:l.value,class:S(s(A)===g.id?"bg-active":""),"on-item-click":e.onItemClick},null,8,["task","nested","search","class","on-item-click"]))),128))]),_:1})):I("",!0)],64)):(u(!0),_(N,{key:1},j(s(o),g=>(u(),M(w,{key:g.id,task:g,nested:e.nested,search:l.value,class:S(s(A)===g.id?"bg-active":""),"on-item-click":e.onItemClick},null,8,["task","nested","search","class","on-item-click"]))),128)),s(i)&&s(o).length===0?(u(),_("div",is,[as,a("button",{"font-light":"",op:"50 hover:100","text-sm":"",border:"~ gray-400/50 rounded",p:"x2 y0.5",m:"t2",onClick:m[3]||(m[3]=g=>l.value="")}," Clear ")])):I("",!0)])])}}})),cs={key:0,"h-full":""},us={"font-bold":"","text-sm":"","flex-auto":"","ws-nowrap":"","overflow-hidden":"",truncate:""},ds={class:"flex text-lg"},ps=T({setup(e){const t=h(()=>{var i;return(i=C.value)==null?void 0:i.name.split(/\//g).pop()}),n=h(()=>{var i,o;return((i=C.value)==null?void 0:i.tasks)&&re((o=C.value)==null?void 0:o.tasks)}),l=()=>C.value&&z.rpc.updateSnapshot(C.value);return(i,o)=>{const r=me,d=J,p=Ae,c=q("tooltip");return s(C)?(u(),_("div",cs,[k(p,{tasks:s(C).tasks,nested:!0},{header:F(()=>[k(r,{"mx-1":"",task:s(C)},null,8,["task"]),a("span",us,x(s(t)),1),a("div",ds,[s(n)?L((u(),M(d,{key:0,icon:"i-carbon-result-old",onClick:o[0]||(o[0]=b=>l())},null,512)),[[c,`Update failed snapshot(s) of ${s(C).name}`,void 0,{bottom:!0}]]):I("",!0),L(k(d,{icon:"i-carbon-play",onClick:o[1]||(o[1]=b=>s(Et)())},null,512),[[c,"Rerun file",void 0,{bottom:!0}]])])]),_:1},8,["tasks"])])):I("",!0)}}}),le=h(()=>E.value.filter(e=>{var t;return((t=e.result)==null?void 0:t.state)==="fail"})),ie=h(()=>E.value.filter(e=>{var t;return((t=e.result)==null?void 0:t.state)==="pass"})),he=h(()=>E.value.filter(e=>e.mode==="skip"||e.mode==="todo"));h(()=>E.value.filter(e=>!le.value.includes(e)&&!ie.value.includes(e)&&!he.value.includes(e)));h(()=>he.value.filter(e=>e.mode==="skip"));const Me=h(()=>E.value.filter(re));h(()=>he.value.filter(e=>e.mode==="todo"));const fs=h(()=>ne.value==="idle"),ce=h(()=>_e(E.value)),vs=h(()=>ce.value.filter(e=>{var t;return((t=e.result)==null?void 0:t.state)==="fail"})),ms=h(()=>ce.value.filter(e=>{var t;return((t=e.result)==null?void 0:t.state)==="pass"})),De=h(()=>ce.value.filter(e=>e.mode==="skip"||e.mode==="todo"));h(()=>De.value.filter(e=>e.mode==="skip"));h(()=>De.value.filter(e=>e.mode==="todo"));h(()=>vs.value.length+ms.value.length);const hs=h(()=>{const e=_e(ce.value).reduce((t,n)=>{var l;return((l=n.result)==null?void 0:l.duration)&&(t+=n.result.duration),t},0);return e>1e3?`${(e/1e3).toFixed(2)}s`:`${Math.round(e)}ms`});function _s(e){return e=e||[],Array.isArray(e)?e:[e]}function _e(e){return _s(e).flatMap(t=>t.type==="test"?[t]:t.tasks.flatMap(n=>n.type==="test"?[n]:_e(n)))}const O=e=>(ht("data-v-09144456"),e=e(),_t(),e),gs={grid:"~ cols-[min-content_1fr_min-content]","items-center":"",gap:"x-2 y-3",p:"x4",relative:"","font-light":"","w-80":"",op80:""},bs=O(()=>a("div",{"i-carbon-document":""},null,-1)),ys=O(()=>a("div",null,"Files",-1)),ks={class:"number"},xs=O(()=>a("div",{"i-carbon-checkmark":""},null,-1)),$s=O(()=>a("div",null,"Pass",-1)),ws={class:"number"},Cs=O(()=>a("div",{"i-carbon-close":""},null,-1)),Ms=O(()=>a("div",null," Fail ",-1)),Ss={class:"number","text-red5":""},Is=O(()=>a("div",{"i-carbon-compare":""},null,-1)),Ts=O(()=>a("div",null," Snapshot Fail ",-1)),Fs={class:"number","text-red5":""},zs=O(()=>a("div",{"i-carbon-timer":""},null,-1)),Ns=O(()=>a("div",null,"Time",-1)),Vs={class:"number"},Rs=T({setup(e){return(t,n)=>(u(),_("div",gs,[bs,ys,a("div",ks,x(s(E).length),1),s(ie).length?(u(),_(N,{key:0},[xs,$s,a("div",ws,x(s(ie).length),1)],64)):I("",!0),s(le).length?(u(),_(N,{key:1},[Cs,Ms,a("div",Ss,x(s(le).length),1)],64)):I("",!0),s(Me).length?(u(),_(N,{key:2},[Is,Ts,a("div",Fs,x(s(Me).length),1)],64)):I("",!0),zs,Ns,a("div",Vs,x(s(hs)),1)]))}});var Es=W(Rs,[["__scopeId","data-v-09144456"]]);const Ls={},Bs={"gap-0":"",flex:"~ col gap-4","h-full":"","justify-center":"","items-center":""},js={"bg-header":"","rounded-lg":"",p:"y4 x2"};function Os(e,t){const n=Es;return u(),_("div",Bs,[a("div",js,[k(n)])])}var As=W(Ls,[["render",Os]]);const Ds={},Ps={h:"full",flex:"~ col"},Us=a("div",{p:"3","h-10":"",flex:"~ gap-2","items-center":"","bg-header":"",border:"b base"},[a("div",{class:"i-carbon-dashboard"}),a("span",{"pl-1":"","font-bold":"","text-sm":"","flex-auto":"","ws-nowrap":"","overflow-hidden":"",truncate:""},"Dashboard")],-1),Gs={class:"scrolls","flex-auto":"","py-1":""};function Ws(e,t){const n=As;return u(),_("div",Ps,[Us,a("div",Gs,[k(n)])])}var Hs=W(Ds,[["render",Ws]]),Ks="/__vitest__/favicon.svg";const ae=R(void 0),K=R(!0);function Ys(){const e=A.value;if(e&&e.length>0){const t=oe(e);t?(ae.value=t,K.value=!1):gt(()=>z.state.getFiles(),()=>{ae.value=oe(e),K.value=!1})}return K}function Se(e){K.value=e,e&&(ae.value=void 0,A.value="")}const Pe=bt(),Xs=yt(Pe),qs=a("img",{"w-6":"","h-6":"",src:Ks},null,-1),Js=a("span",{"font-light":"","text-sm":"","flex-1":""},"Vitest",-1),Qs={class:"flex text-lg"},Zs=T({setup(e){const t=h(()=>E.value&&re(E.value)),n=()=>z.rpc.updateSnapshot();function l(o){A.value=o.id,ae.value=oe(o.id),Se(!1)}const i=h(()=>Pe.value?"light":"dark");return(o,r)=>{const d=J,p=Ae,c=q("tooltip");return u(),M(p,{border:"r base",tasks:s(E),"on-item-click":l,"group-by-type":!0,onRun:s(Ce)},{header:F(({filteredTests:b})=>[qs,Js,a("div",Qs,[L(k(d,{title:"Show dashboard",class:"!animate-100ms","animate-count-1":"",icon:"i-carbon-dashboard",onClick:r[0]||(r[0]=f=>s(Se)(!0))},null,512),[[Ne,!s(K)],[c,"Dashboard",void 0,{bottom:!0}]]),s(t)?L((u(),M(d,{key:0,icon:"i-carbon-result-old",onClick:r[1]||(r[1]=f=>n())},null,512)),[[c,"Update all failed snapshot(s)",void 0,{bottom:!0}]]):I("",!0),L(k(d,{disabled:(b==null?void 0:b.length)===0,icon:"i-carbon-play",onClick:f=>s(Ce)(b)},null,8,["disabled","onClick"]),[[c,b?b.length===0?"No test to run (clear filter)":"Rerun filtered":"Rerun all",void 0,{bottom:!0}]]),L(k(d,{icon:"dark:i-carbon-moon i-carbon-sun",onClick:r[2]||(r[2]=f=>s(Xs)())},null,512),[[c,`Toggle to ${s(i)} mode`,void 0,{bottom:!0}]])])]),_:1},8,["tasks","onRun"])}}});const eo={"h-3px":"",relative:"","overflow-hidden":"",class:"px-0","w-screen":""},to=T({setup(e){const{width:t}=kt(),n=h(()=>E.value.length===0?"!bg-gray-4 !dark:bg-gray-7 in-progress":fs.value?null:"in-progress"),l=h(()=>E.value.length),i=h(()=>ie.value.length),o=h(()=>le.value.length),r=h(()=>{const b=s(l);return b>0?t.value*i.value/b:0}),d=h(()=>{const b=s(l);return b>0?t.value*o.value/b:0}),p=h(()=>s(l)-o.value-i.value),c=h(()=>{const b=s(l);return b>0?t.value*p.value/b:0});return(b,f)=>(u(),_("div",{absolute:"","t-0":"","l-0":"","r-0":"","z-index-1031":"","pointer-events-none":"","p-0":"","h-3px":"",grid:"~ auto-cols-max","justify-items-center":"","w-screen":"",class:S(s(n))},[a("div",eo,[a("div",{absolute:"","l-0":"","t-0":"","bg-red5":"","h-3px":"",class:S(s(n)),style:G(`width: ${s(d)}px;`)}," \xA0 ",6),a("div",{absolute:"","l-0":"","t-0":"","bg-green5":"","h-3px":"",class:S(s(n)),style:G(`left: ${s(d)}px; width: ${s(r)}px;`)}," \xA0 ",6),a("div",{absolute:"","l-0":"","t-0":"","bg-yellow5":"","h-3px":"",class:S(s(n)),style:G(`left: ${s(r)+s(d)}px; width: ${s(c)}px;`)}," \xA0 ",6)])],2))}});var no=W(to,[["__scopeId","data-v-513f7dd8"]]);const so={"h-screen":"","w-screen":"",overflow:"hidden"},oo=T({setup(e){const t=Ys(),n=pe([33,67]),l=pe([33,67]),i=we(d=>{d.forEach((p,c)=>{n[c]=p.size})},0),o=we(d=>{d.forEach((p,c)=>{l[c]=p.size})},0),r=()=>{const d=window.innerWidth,p=Math.min(d/3,300);n[0]=100*p/d,n[1]=100-n[0],l[0]=100*p/(d-p),l[1]=100-l[0]};return(d,p)=>{const c=no,b=Zs,f=Hs,v=ps,m=Bn,w=jt;return u(),_(N,null,[k(c),a("div",so,[k(s($e),{class:"pt-4px",onResized:s(i),onReady:r},{default:F(()=>[k(s(ee),{size:s(n)[0]},{default:F(()=>[k(b)]),_:1},8,["size"]),k(s(ee),{size:s(n)[1]},{default:F(()=>[k(xt,null,{default:F(()=>[s(t)?(u(),M(f,{key:"summary"})):(u(),M(s($e),{key:"detail",onResized:s(o)},{default:F(()=>[k(s(ee),{size:s(l)[0]},{default:F(()=>[k(v)]),_:1},8,["size"]),k(s(ee),{size:s(l)[1]},{default:F(()=>[k(m)]),_:1},8,["size"])]),_:1},8,["onResized"]))]),_:1})]),_:1},8,["size"])]),_:1},8,["onResized"])]),k(w)],64)}}}),lo=[{name:"index",path:"/",component:oo,props:!0}],io={};function ao(e,t){const n=Ve("RouterView");return u(),M(n)}var ro=W(io,[["render",ao]]);const ge=$t(ro),co=wt({history:Ct("/__vitest__/"),routes:lo});ge.use(co);ge.directive("tooltip",Mt);Re.options.instantMove=!0;Re.options.distance=10;ge.mount("#app");
